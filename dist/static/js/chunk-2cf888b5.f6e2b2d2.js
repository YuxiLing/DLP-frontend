(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2cf888b5"],{"0b0f":function(t,e,n){},"12cb":function(t,e,n){},"20b2":function(t,e,n){},"34c6":function(t,e,n){"use strict";n.d(e,"a",(function(){return l})),n.d(e,"b",(function(){return a}));var r=n("b775");function l(){return Object(r["a"])({url:"/dlp/rule/namelist",method:"get"})}function a(){return Object(r["a"])({url:"/dlp/rule/list",method:"get"})}},5347:function(t,e,n){"use strict";var r=n("0b0f"),l=n.n(r);l.a},"6b30":function(t,e,n){"use strict";var r=n("20b2"),l=n.n(r);l.a},"95d56":function(t,e,n){"use strict";n.d(e,"a",(function(){return l})),n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return i})),n.d(e,"d",(function(){return o})),n.d(e,"e",(function(){return s})),n.d(e,"f",(function(){return u}));var r=n("b775");function l(t){return Object(r["a"])({url:"/dlp/violation/client/chart",method:"get",params:t})}function a(t){return Object(r["a"])({url:"/dlp/client/onlinechart",method:"get",params:t})}function i(t){return Object(r["a"])({url:"/dlp/client/validatechart",method:"get",params:t})}function o(t){return Object(r["a"])({url:"/dlp/scan/resultchart",method:"get",params:t})}function s(t){return Object(r["a"])({url:"/dlp/validation/total",methods:"get",params:{time_scale:t}})}function u(){return Object(r["a"])({url:"/dlp/scan/percent",methods:"get"})}},a700:function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"scan-result-container"},[n("div",{staticClass:"result-header"},[t._v("\n        敏感数据扫描\n    ")]),t._v(" "),n("div",{staticClass:"result-chart"},[n("PartA",{staticStyle:{float:"left"}}),t._v(" "),n("PartB",{staticStyle:{float:"left"}})],1),t._v(" "),n("div",{staticClass:"result-divider"}),t._v(" "),n("PartC",{staticStyle:{margin:"10px"}})],1)},l=[],a=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},i=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"partA-container"},[n("div",{staticClass:"result-title"},[n("div",{staticClass:"title-pic"}),t._v(" "),n("div",{staticClass:"title-text"},[t._v("扫描结果统计")])]),t._v(" "),n("div",{staticClass:"result-partA-body",attrs:{id:"scan_chart"}})])}],o=(n("7f7f"),n("95d56")),s={name:"PartA",data:function(){return{scan_data:{total_scan:0,non_scan:0,warn_scan:0,erro_scan:0},timer:null,refreshTimeLoop:null}},watch:{scan_data:function(t){this.initChart()}},mounted:function(){var t=this;this.getData(),this.refreshTimeLoop=this.$parent.getPageTimeSetting(),this.timer?clearInterval(timer):this.timer=setInterval((function(){t.getData()}),this.refreshTimeLoop)},methods:{getData:function(){var t=this;Object(o["d"])().then((function(e){t.scan_data=e.data.items}))},initChart:function(){var t=this.$echarts.init(document.getElementById("scan_chart")),e=this.getOptions();t.setOption(e)},getOptions:function(){for(var t=Math.floor(100*(17/this.scan_data.total_scan).toFixed(2)),e=Math.floor(100*(this.scan_data.non_scan/this.scan_data.total_scan).toFixed(2)),n=Math.floor(100*(this.scan_data.warn_scan/this.scan_data.total_scan).toFixed(2)),r=Math.floor(100*(this.scan_data.erro_scan/this.scan_data.total_scan).toFixed(2)),l=[{name:"已处理扫描次数",value:t},{name:"未检测到敏感数据次数",value:e},{name:"检测到敏感数据次数",value:n},{name:"误报次数",value:r}],a=[],i=[],o=[["#389af4","#dfeaff"],["#ff8c37","#ffdcc3"],["#ffc257","#ffedcc"],["#fd6f97","#fed4e0"],["#a181fc","#e3d9fe"]],s=0;s<l.length;s++){var u=l[s];a.push({text:u.name,left:25*s+10+"%",top:"50%",textAlign:"center",textStyle:{fontWeight:"normal",fontSize:"10",color:o[s][0],textAlign:"center"}}),i.push({name:u.name,type:"pie",top:"-5%",clockWise:!1,radius:[55,60],itemStyle:{normal:{color:o[s][0],shadowColor:o[s][0],shadowBlur:0,label:{show:!1},labelLine:{show:!1}}},hoverAnimation:!1,center:[25*s+10+"%","50%"],data:[{value:u.value,label:{normal:{formatter:function(t){return t.value+"%"},position:"center",show:!0,textStyle:{fontSize:"20",fontWeight:"bold",color:o[s][0]}}}},{value:100-u.value,name:"invisible",itemStyle:{normal:{color:o[s][1]},emphasis:{color:o[s][1]}}}]})}var c={title:a,series:i};return c}}},u=s,c=(n("daca"),n("2877")),f=Object(c["a"])(u,a,i,!1,null,null,null),d=f.exports,h=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},p=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"partB-container"},[n("div",{staticClass:"result-title"},[n("div",{staticClass:"title-pic"}),t._v(" "),n("div",{staticClass:"title-text"},[t._v("扫描敏感数据百分比统计")])]),t._v(" "),n("div",{staticClass:"result-partB-chart",attrs:{id:"scan_percent_chart"}})])}],m={name:"PartB",data:function(){return{percent_chart:[],timer:null,refreshTimeLoop:5e3}},watch:{percent_chart:function(t){this.initChart()}},mounted:function(){var t=this;this.refreshTimeLoop=this.$parent.getPageTimeSetting(),this.getData(),this.timer?clearInterval(this.timer):this.timer=setInterval((function(){t.getData()}),this.refreshTimeLoop)},methods:{getData:function(){var t=this;Object(o["f"])().then((function(e){t.percent_chart=e.data.items}))},initChart:function(){var t=this.$echarts.init(document.getElementById("scan_percent_chart")),e=this.getOption();t.setOption(e)},getOption:function(){for(var t=[],e=[],n=0;n<this.percent_chart.length;n++)t.push(this.percent_chart[n].percent),e.push(this.percent_chart[n].name);var r=["#FFA483","#F97F53","#F45922"],l={title:{text:"近六次扫描情况",right:"10%",textStyle:{color:"#000",fontSize:12}},backgroundColor:"#fff",grid:{left:"2%",right:"10%",bottom:"10%",top:"10%",containLabel:!0},xAxis:[{show:!1},{show:!1}],yAxis:{type:"category",inverse:!0,show:!1},series:[{show:!0,type:"bar",barGap:"-100%",barWidth:"20%",z:2,itemStyle:{normal:{color:function(t){var e=r.length;return r[t.dataIndex%e]}}},label:{normal:{show:!0,textStyle:{color:"#000",fontSize:15,fontWeight:"bold"},position:"right",formatter:function(e){return t[e.dataIndex].toFixed(2)+"%"}}},data:t},{show:!0,type:"bar",xAxisIndex:1,barGap:"-100%",barWidth:"10%",itemStyle:{normal:{barBorderRadius:200,color:"transparent"}},label:{normal:{show:!0,position:[0,"-15"],textStyle:{fontSize:12,color:"#333"},formatter:function(t){return e[t.dataIndex]}}},data:t}]};return l}}},v=m,b=(n("5347"),Object(c["a"])(v,h,p,!1,null,null,null)),y=b.exports,g=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"partC-container"},[t._m(0),t._v(" "),n("div",{staticClass:"partC-toolBar"},[n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){t.open_form=!0}}},[t._v("新建扫描")]),t._v(" "),n("el-drawer",{ref:"drawer",attrs:{title:"创建扫描","before-close":t.handleClose,visible:t.open_form,direction:"rtl","custom-class":"demo-drawer",size:"40%"},on:{"update:visible":function(e){t.open_form=e}}},[n("div",{staticClass:"result-drawer_content"},[n("el-form",{attrs:{model:t.form,"label-width":"100px","label-suffix":""}},[n("el-form-item",{attrs:{label:"扫描名称"}},[n("el-input",{staticStyle:{width:"300px"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"扫描客户端"}},[n("el-cascader",{staticStyle:{},attrs:{options:t.clientOptions,props:{multiple:!0,checkStrictly:!0}},on:{change:function(e){return t.handleChange()}},model:{value:t.selectedSet,callback:function(e){t.selectedSet=e},expression:"selectedSet"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"扫描策略"}},[n("span",{staticStyle:{display:"inline-block",width:"40px"}},[t._v("And")]),t._v(" "),n("el-select",{attrs:{multiple:"",filterable:"",placeholder:"请选择"},on:{change:function(e){return t.updateRuleOptions23()}},model:{value:t.selectedRule1,callback:function(e){t.selectedRule1=e},expression:"selectedRule1"}},t._l(t.ruleOptions1,(function(t){return n("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1),t._v(" "),n("br"),t._v(" "),n("span",{staticStyle:{display:"inline-block",width:"40px"}},[t._v("Or")]),t._v(" "),n("el-select",{attrs:{multiple:"",filterable:"",placeholder:"请选择"},on:{change:function(e){return t.updateRuleOptions13()}},model:{value:t.selectedRule2,callback:function(e){t.selectedRule2=e},expression:"selectedRule2"}},t._l(t.ruleOptions2,(function(t){return n("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1),t._v(" "),n("br"),t._v(" "),n("span",{staticStyle:{display:"inline-block",width:"40px"}},[t._v("Not")]),t._v(" "),n("el-select",{attrs:{multiple:"",filterable:"",placeholder:"请选择"},on:{change:function(e){return t.updateRuleOptions12()}},model:{value:t.selectedRule3,callback:function(e){t.selectedRule3=e},expression:"selectedRule3"}},t._l(t.ruleOptions3,(function(t){return n("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1),t._v(" "),n("br")],1),t._v(" "),n("el-form-item",{attrs:{label:"备注"}},[n("el-input",{staticStyle:{width:"400px"},attrs:{type:"textarea",rows:4},model:{value:t.form.comment,callback:function(e){t.$set(t.form,"comment",e)},expression:"form.comment"}})],1)],1),t._v(" "),n("div",{staticClass:"result-drawer_footer",staticStyle:{"text-align":"center"}},[n("el-button",{on:{click:t.cancelForm}},[t._v("取 消")]),t._v(" "),n("el-button",{attrs:{type:"primary",loading:t.loading},on:{click:function(e){return t.submitForm()}}},[t._v(t._s(t.loading?"提交中...":"确定"))])],1)],1)]),t._v(" "),n("el-autocomplete",{attrs:{"fetch-suggestions":t.querySearch,placeholder:"搜索扫描事件","trigger-on-focus":!1,size:"small"},on:{select:t.handleSelect},model:{value:t.searchKeyWords,callback:function(e){t.searchKeyWords=e},expression:"searchKeyWords"}},[n("i",{staticClass:"el-icon-edit el-input__icon",attrs:{slot:"suffix"},on:{click:t.handleIconClick},slot:"suffix"})])],1),t._v(" "),n("el-table",{staticStyle:{width:"100%","font-size":"11px","margin-top":"10px"},attrs:{data:t.tableData.slice((t.currentPage-1)*t.pageSize,t.currentPage*t.pageSize),"header-cell-style":{background:"#eef1f6"},"row-style":{height:"50px"},"default-sort":{prop:"time",order:"descending"}}},[n("el-table-column",{attrs:{prop:"time",label:"创建时间",width:"200px",sortable:""}}),t._v(" "),n("el-table-column",{attrs:{prop:"name",label:"扫描名称",width:"130px"}}),t._v(" "),n("el-table-column",{attrs:{prop:"ip",label:"扫描客户端",width:"130px"}}),t._v(" "),n("el-table-column",{attrs:{prop:"rule",label:"扫描策略",width:"130px"}}),t._v(" "),n("el-table-column",{attrs:{prop:"comment",label:"备注",width:"200px"}}),t._v(" "),n("el-table-column",{attrs:{prop:"result",label:"扫描结果",width:"150px",filters:t.filterSet1,"filter-method":t.filterResult}}),t._v(" "),n("el-table-column",{attrs:{type:"expand"}},[[n("el-form",{staticClass:"demo-table-expand",attrs:{"label-position":"left",inline:""}})]],2),t._v(" "),n("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{type:"text",size:"small"}},[t._v("结果详情")]),t._v(" "),n("el-button",{staticStyle:{color:"red"},attrs:{type:"text",size:"small"},on:{click:function(n){return t.wrongResult(e.row.name)}}},[t._v("误报")])]}}])})],1),t._v(" "),n("el-pagination",{attrs:{"current-page":t.currentPage,layout:"prev, pager, next","page-size":t.pageSize,total:t.tableData.length},on:{"current-change":t.handleCurrentChange}})],1)},_=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"result-title"},[n("div",{staticClass:"title-pic"}),t._v(" "),n("div",{staticClass:"title-text"},[t._v("扫描结果列表")])])}],O=(n("ac4d"),n("8a81"),n("ac6a"),n("bd86")),x=n("b775");function S(){return Object(x["a"])({url:"/dlp/scan/result/list",method:"get"})}function w(t){return Object(x["a"])({url:"/dlp/scan/result/list",method:"post",data:t})}var R=n("b39f"),C=n("34c6"),k={name:"PartC",data:function(){var t;return t={tableData:[],currentPage:1,pageSize:10,group:[],allClient:[],filterSet1:[{text:"已完成",value:"已完成"},{text:"未完成",value:"未完成"}],clientOptions:[],selectedSet:[],ruleOptions1:[],ruleOptions2:[],ruleOptions3:[],fullRuleOptions:[],selectedRule1:[],selectedRule2:[],selectedRule3:[],clientNameList:[],state:"",searchKeyWords:"",open_form:!1,loading:!1,form:{name:"",clients:[],rules:[{method:"",rule:""}],comment:""},timer:null,formLabelWidth:"80px"},Object(O["a"])(t,"currentPage",1),Object(O["a"])(t,"pagesize",10),t},mounted:function(){var t=this;this.getTableData(),this.getOtherData(),setTimeout((function(){t.setClientOptions(),t.setRuleOptions()}),500)},methods:Object(O["a"])({getTableData:function(){var t=this;S().then((function(e){t.tableData=e.data}))},handleCurrentChange:function(t){this.currentPage=t},getOtherData:function(){var t=this;Object(R["c"])().then((function(e){t.allClient=e.data})),Object(R["e"])().then((function(e){t.group=e.data})),Object(C["a"])().then((function(e){t.fullRuleOptions=e.data}))},clearForm:function(){this.form={name:"",clients:[],rules:[{method:"",rule:""}],comment:""},this.selectedRule1=[],this.selectedRule2=[],this.selectedRule3=[],this.selectedSet=[]},handleChange:function(){var t=[];this.form.clients=[];var e=!0,n=!1,r=void 0;try{for(var l,a=this.selectedSet[Symbol.iterator]();!(e=(l=a.next()).done);e=!0){var i=l.value;if(1==i.length){t.push(i[0]);var o=!0,s=!1,u=void 0;try{for(var c,f=this.allClient[Symbol.iterator]();!(o=(c=f.next()).done);o=!0){var d=c.value;d.group==i[0]&&this.form.clients.push(d.value)}}catch(h){s=!0,u=h}finally{try{o||null==f.return||f.return()}finally{if(s)throw u}}}else-1==t.indexOf(i[0])&&this.form.clients.push(i[1])}}catch(h){n=!0,r=h}finally{try{e||null==a.return||a.return()}finally{if(n)throw r}}},setClientOptions:function(){var t=this.group,e=this.allClient,n=!0,r=!1,l=void 0;try{for(var a,i=t[Symbol.iterator]();!(n=(a=i.next()).done);n=!0){var o=a.value,s=[],u=!0,c=!1,f=void 0;try{for(var d,h=e[Symbol.iterator]();!(u=(d=h.next()).done);u=!0){var p=d.value;p.group==o.value&&s.push({value:p.value,label:p.label})}}catch(v){c=!0,f=v}finally{try{u||null==h.return||h.return()}finally{if(c)throw f}}var m={value:o.value,label:o.label,children:s};this.clientOptions.push(m)}}catch(v){r=!0,l=v}finally{try{n||null==i.return||i.return()}finally{if(r)throw l}}},makeRuleSet:function(){this.form.rules=[];var t=!0,e=!1,n=void 0;try{for(var r,l=this.selectedRule1[Symbol.iterator]();!(t=(r=l.next()).done);t=!0){var a=r.value;this.form.rules.push({method:"and",rule:a})}}catch(v){e=!0,n=v}finally{try{t||null==l.return||l.return()}finally{if(e)throw n}}var i=!0,o=!1,s=void 0;try{for(var u,c=this.selectedRule2[Symbol.iterator]();!(i=(u=c.next()).done);i=!0){a=u.value;this.form.rules.push({method:"or",rule:a})}}catch(v){o=!0,s=v}finally{try{i||null==c.return||c.return()}finally{if(o)throw s}}var f=!0,d=!1,h=void 0;try{for(var p,m=this.selectedRule2[Symbol.iterator]();!(f=(p=m.next()).done);f=!0){a=p.value;this.form.rules.push({method:"not",rule:a})}}catch(v){d=!0,h=v}finally{try{f||null==m.return||m.return()}finally{if(d)throw h}}},setRuleOptions:function(){this.ruleOptions1=this.fullRuleOptions,this.ruleOptions2=this.fullRuleOptions,this.ruleOptions3=this.fullRuleOptions},sliceTmp:function(t,e){var n=!0,r=!1,l=void 0;try{for(var a,i=t[Symbol.iterator]();!(n=(a=i.next()).done);n=!0){var o=a.value;if(e==o.value){var s=t.indexOf(o);t.splice(s,1);break}}}catch(u){r=!0,l=u}finally{try{n||null==i.return||i.return()}finally{if(r)throw l}}return t},updateRuleOptions1:function(t){var e=JSON.parse(t),n=!0,r=!1,l=void 0;try{for(var a,i=this.selectedRule2[Symbol.iterator]();!(n=(a=i.next()).done);n=!0){var o=a.value;e=this.sliceTmp(e,o)}}catch(h){r=!0,l=h}finally{try{n||null==i.return||i.return()}finally{if(r)throw l}}var s=!0,u=!1,c=void 0;try{for(var f,d=this.selectedRule3[Symbol.iterator]();!(s=(f=d.next()).done);s=!0){o=f.value;e=this.sliceTmp(e,o)}}catch(h){u=!0,c=h}finally{try{s||null==d.return||d.return()}finally{if(u)throw c}}this.ruleOptions1=e},updateRuleOptions2:function(t){var e=JSON.parse(t),n=!0,r=!1,l=void 0;try{for(var a,i=this.selectedRule1[Symbol.iterator]();!(n=(a=i.next()).done);n=!0){var o=a.value;e=this.sliceTmp(e,o)}}catch(h){r=!0,l=h}finally{try{n||null==i.return||i.return()}finally{if(r)throw l}}var s=!0,u=!1,c=void 0;try{for(var f,d=this.selectedRule3[Symbol.iterator]();!(s=(f=d.next()).done);s=!0){o=f.value;e=this.sliceTmp(e,o)}}catch(h){u=!0,c=h}finally{try{s||null==d.return||d.return()}finally{if(u)throw c}}this.ruleOptions2=e},updateRuleOptions3:function(t){var e=JSON.parse(t),n=!0,r=!1,l=void 0;try{for(var a,i=this.selectedRule1[Symbol.iterator]();!(n=(a=i.next()).done);n=!0){var o=a.value;e=this.sliceTmp(e,o)}}catch(h){r=!0,l=h}finally{try{n||null==i.return||i.return()}finally{if(r)throw l}}var s=!0,u=!1,c=void 0;try{for(var f,d=this.selectedRule2[Symbol.iterator]();!(s=(f=d.next()).done);s=!0){o=f.value;e=this.sliceTmp(e,o)}}catch(h){u=!0,c=h}finally{try{s||null==d.return||d.return()}finally{if(u)throw c}}this.ruleOptions3=e},updateRuleOptions23:function(){var t=JSON.stringify(this.fullRuleOptions);this.updateRuleOptions2(t),this.updateRuleOptions3(t)},updateRuleOptions13:function(){var t=JSON.stringify(this.fullRuleOptions);this.updateRuleOptions1(t),this.updateRuleOptions3(t)},updateRuleOptions12:function(){var t=JSON.stringify(this.fullRuleOptions);this.updateRuleOptions1(t),this.updateRuleOptions2(t)},handleClose:function(){var t=this;this.loading||this.$confirm("还有未提交表单，你确定离开吗？").then((function(e){t.clearForm(),t.loading=!1,t.open_form=!1})).catch((function(t){}))},cancelForm:function(){this.loading||(this.clearForm(),this.open_form=!1)},submitForm:function(t){var e=this;this.loading=!0,this.makeRuleSet(),console.log(this.form),w(this.form).then((function(t){200==t.code?setTimeout((function(){e.getTableData(),e.loading=!1,e.open_form=!1}),400):e.$alert("创建失败，请重试")})),console.log(this.form),this.clearForm()},handleSelect:function(t){},querySearch:function(t,e){},createFilter:function(t){return function(e){return 0==e.value.toLowerCase().indexOf(t.toLowerCase())}},handleIconClick:function(){},filterResult:function(t,e){return e.result==t},wrongResult:function(t){this.$confirm("将扫描事件"+t+"设置为误报吗？").then((function(t){})).catch((function(t){}))},handleSizeChange:function(t){this.pagesize=t}},"handleCurrentChange",(function(t){this.currentPage=t}))},j=k,T=(n("6b30"),Object(c["a"])(j,g,_,!1,null,null,null)),z=T.exports,F={components:{PartA:d,PartB:y,PartC:z},data:function(){return{refreshTime:6e5}},methods:{getPageTimeSetting:function(){return this.refreshTime}}},P=F,$=(n("e262"),Object(c["a"])(P,r,l,!1,null,null,null));e["default"]=$.exports},b39f:function(t,e,n){"use strict";n.d(e,"e",(function(){return l})),n.d(e,"a",(function(){return a})),n.d(e,"d",(function(){return i})),n.d(e,"c",(function(){return o})),n.d(e,"f",(function(){return s})),n.d(e,"h",(function(){return u})),n.d(e,"i",(function(){return c})),n.d(e,"b",(function(){return f})),n.d(e,"g",(function(){return d}));var r=n("b775");function l(){return Object(r["a"])({url:"/dlp/client/group",method:"get"})}function a(t){return Object(r["a"])({url:"/dlp/client/group",method:"post",params:{form:t}})}function i(){return Object(r["a"])({url:"/dlp/client/infogroup",method:"get"})}function o(){return Object(r["a"])({url:"/dlp/client/list",method:"get"})}function s(){return Object(r["a"])({url:"/dlp/client/ip",method:"get"})}function u(){return Object(r["a"])({url:"/dlp/client/status",method:"get"})}function c(t,e){return Object(r["a"])({url:"/dlp/client/validateinfo",method:"get",params:{type:t,key:e}})}function f(){return Object(r["a"])({url:"/dlp/client/info",method:"get"})}function d(){return Object(r["a"])({url:"/dlp/client/nogroup",method:"get"})}},d81f:function(t,e,n){},daca:function(t,e,n){"use strict";var r=n("d81f"),l=n.n(r);l.a},e262:function(t,e,n){"use strict";var r=n("12cb"),l=n.n(r);l.a}}]);