(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-80619ca0"],{"112a":function(t,e,a){"use strict";var l=a("2ee8"),n=a.n(l);n.a},"2ee8":function(t,e,a){},4406:function(t,e,a){},"49ac":function(t,e,a){"use strict";a.d(e,"f",(function(){return n})),a.d(e,"e",(function(){return i})),a.d(e,"c",(function(){return r})),a.d(e,"d",(function(){return o})),a.d(e,"g",(function(){return s})),a.d(e,"b",(function(){return c})),a.d(e,"h",(function(){return u})),a.d(e,"a",(function(){return d}));var l=a("b775");function n(t){return Object(l["a"])({url:"/dlp/wrong/result/list",method:"get",params:{form:t}})}function i(t){return Object(l["a"])({url:"/dlp/wrong/result/detail",method:"get",params:{id:t}})}function r(t,e){return Object(l["a"])({url:"/dlp/wrong/chart1",method:"get",params:{time_scale:t,activeName:e}})}function o(t,e){return Object(l["a"])({url:"/dlp/wrong/chart2",method:"get",params:{time_scale:t,activeName:e}})}function s(){return Object(l["a"])({url:"/dlp/wrong/rules",method:"get"})}function c(t){return Object(l["a"])({url:"/dlp/wrong/rules",method:"delete",params:{id:t}})}function u(t){return Object(l["a"])({url:"/dlp/wrong/rules",method:"post",params:{form:t}})}function d(t,e){return Object(l["a"])({url:"/dlp/wrong/rules/status",method:"put",params:{id:t,status:e}})}},a4e3:function(t,e,a){"use strict";var l=a("4406"),n=a.n(l);n.a},b39f:function(t,e,a){"use strict";a.d(e,"e",(function(){return n})),a.d(e,"a",(function(){return i})),a.d(e,"d",(function(){return r})),a.d(e,"c",(function(){return o})),a.d(e,"f",(function(){return s})),a.d(e,"h",(function(){return c})),a.d(e,"i",(function(){return u})),a.d(e,"b",(function(){return d})),a.d(e,"g",(function(){return p}));var l=a("b775");function n(){return Object(l["a"])({url:"/dlp/client/group",method:"get"})}function i(t){return Object(l["a"])({url:"/dlp/client/group",method:"post",params:{form:t}})}function r(){return Object(l["a"])({url:"/dlp/client/infogroup",method:"get"})}function o(){return Object(l["a"])({url:"/dlp/client/list",method:"get"})}function s(){return Object(l["a"])({url:"/dlp/client/ip",method:"get"})}function c(){return Object(l["a"])({url:"/dlp/client/status",method:"get"})}function u(t,e){return Object(l["a"])({url:"/dlp/client/validateinfo",method:"get",params:{type:t,key:e}})}function d(){return Object(l["a"])({url:"/dlp/client/info",method:"get"})}function p(){return Object(l["a"])({url:"/dlp/client/nogroup",method:"get"})}},b65c:function(t,e,a){"use strict";a.r(e);var l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"wrong-result-container"},[a("div",{staticClass:"result-header"},[t._v("\n        异常事件统计\n    ")]),t._v(" "),a("PartA"),t._v(" "),a("div",{staticClass:"wrong-result-divider"}),t._v(" "),a("PartB")],1)},n=[],i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"wrong-result-partA"},[[a("el-tabs",{model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[a("el-tab-pane",{attrs:{name:"first"}},[a("span",{staticStyle:{"font-size":"12px",color:"#303133"},attrs:{slot:"label"},slot:"label"},[t._v("全部")]),t._v(" "),[a("div",{staticClass:"button-bar"},[a("div",{class:1==t.time_scale?"buttonsOn":"buttonsOff",on:{click:function(e){return t.setTimeScale(1)}}},[t._v("7天")]),t._v(" "),a("div",{class:2==t.time_scale?"buttonsOn":"buttonsOff",on:{click:function(e){return t.setTimeScale(2)}}},[t._v("1个月")]),t._v(" "),a("div",{class:3==t.time_scale?"buttonsOn":"buttonsOff",on:{click:function(e){return t.setTimeScale(3)}}},[t._v("6个月")]),t._v(" "),a("div",{class:4==t.time_scale?"buttonsOn":"buttonsOff",on:{click:function(e){return t.setTimeScale(4)}}},[t._v("12个月")])]),t._v(" "),a("div",{staticStyle:{"text-align":"center"}},[a("div",{staticClass:"wrong-chartA",attrs:{id:"validation-chart"}}),t._v(" "),a("div",{staticClass:"wrong-chart-divider"}),t._v(" "),a("div",{staticClass:"wrong-chartB",attrs:{id:"validate-ip-chart"}})])]],2),t._v(" "),a("el-tab-pane",{attrs:{name:"second"}},[a("span",{staticStyle:{"font-size":"12px",color:"#303133"},attrs:{slot:"label"},slot:"label"},[t._v("USB禁止")])]),t._v(" "),a("el-tab-pane",{attrs:{name:"third"}},[a("span",{staticStyle:{"font-size":"12px",color:"#303133"},attrs:{slot:"label"},slot:"label"},[t._v("Email禁止")])]),t._v(" "),a("el-tab-pane",{attrs:{name:"fourth"}},[a("span",{staticStyle:{"font-size":"12px",color:"#303133"},attrs:{slot:"label"},slot:"label"},[t._v("WEB拦截")])]),t._v(" "),a("el-tab-pane",{attrs:{name:"fifth"}},[a("span",{staticStyle:{"font-size":"12px",color:"#303133"},attrs:{slot:"label"},slot:"label"},[t._v("打印机拦截")])]),t._v(" "),a("el-tab-pane",{attrs:{name:"sixth"}},[a("span",{staticStyle:{"font-size":"12px",color:"#303133"},attrs:{slot:"label"},slot:"label"},[t._v("截屏禁止")])])],1)]],2)},r=[],o=a("49ac"),s={name:"PartA",data:function(){return{activeName:"first",time_scale:1,chart_data:[{date:"",value:""}],chart_data2:[{date:"",value:""}],refreshTimeLoop:null,timer:null}},watch:{chart_data:function(t){this.initChart1()},chart_data2:function(t){this.initChart2()}},mounted:function(){var t=this;this.getChartData(),this.refreshTimeLoop=6e4,this.timer?clearInterval(timer):this.timer=setInterval((function(){t.getChartData()}),this.refreshTimeLoop)},methods:{getChartData:function(){var t=this;Object(o["c"])(this.time_scale,this.activeName).then((function(e){t.chart_data=e.data})),Object(o["d"])(this.time_scale,this.activeName).then((function(e){t.chart_data2=e.data}))},initChart1:function(){var t=this.$echarts.init(document.getElementById("validation-chart")),e=this.getOption();t.setOption(e)},initChart2:function(){var t=this.$echarts.init(document.getElementById("validate-ip-chart")),e=this.getOption2();t.setOption(e)},getOption:function(){for(var t=[],e=[],a=["#33A02C","#B2DF8A","#A6CEE3","#1F78B4","#FB9A99","#E31A1C"],l=[],n=0;n<this.chart_data.length;n++)l.push(this.chart_data[n].value);var i=Math.max.apply(Math,l);for(n=0;n<this.chart_data.length;n++){var r=null,o=this.chart_data[n].value,s=this.chart_data[n].date,c=Math.ceil(6*o/i)-1;r=a[c],t.push(s),e.push({name:s,value:o,itemStyle:{color:r}})}var u={tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},grid:{left:"3%",right:"4%",bottom:"10%",containLabel:!0},xAxis:[{type:"category",axisTick:{show:!1,color:"#707070"},axisLabel:{textStyle:{fontSize:11,color:"#4D4D4D"}},axisLine:{lineStyle:{color:"#707070"}},data:t}],yAxis:{type:"value",name:"违规次数",nameTextStyle:{fontSize:11,color:"#4D4D4D"},axisLabel:{textStyle:{fontSize:10,color:"#4D4D4D"}},axisLine:{lineStyle:{color:"#707070"}}},series:[{name:"违规次数",type:"bar",barWidth:"60%",color:a,data:e}]};return u},getOption2:function(){for(var t=[],e=[],a=["#33A02C","#B2DF8A","#A6CEE3","#1F78B4","#FB9A99","#E31A1C"],l=[],n=0;n<this.chart_data2.length;n++)l.push(this.chart_data2[n].value);var i=Math.max.apply(Math,l);for(n=0;n<this.chart_data2.length;n++){var r=null,o=this.chart_data2[n].value,s=this.chart_data2[n].ip,c=Math.ceil(6*o/i)-1;r=a[c],t.push(s),e.push({name:s,value:o,itemStyle:{color:r}})}var u={tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},grid:{left:"3%",right:"4%",bottom:"10%",containLabel:!0},xAxis:[{type:"category",axisTick:{show:!1,color:"#707070"},axisLabel:{textStyle:{fontSize:11,color:"#4D4D4D"}},axisLine:{lineStyle:{color:"#707070"}},data:t}],yAxis:{type:"value",name:"违规次数",nameTextStyle:{fontSize:11,color:"#4D4D4D"},axisLabel:{textStyle:{fontSize:10,color:"#4D4D4D"}},axisLine:{lineStyle:{color:"#707070"}}},series:[{name:"违规次数",type:"bar",barWidth:"60%",color:a,data:e}]};return u},setTimeScale:function(t){this.time_scale=t,this.getChartData()}}},c=s,u=(a("a4e3"),a("2877")),d=Object(u["a"])(c,i,r,!1,null,null,null),p=d.exports,h=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"wrong-result-partB"},[t._m(0),t._v(" "),a("div",{staticStyle:{float:"left",margin:"10px 0px"}},[a("el-select",{staticStyle:{width:"130px"},attrs:{placeholder:"选择策略类型",size:"mini"},model:{value:t.stratedy,callback:function(e){t.stratedy=e},expression:"stratedy"}},t._l(t.stratedySet,(function(e){return a("el-option",{key:e.value,attrs:{value:e.value,label:e.label}},[t._v("\n                "+t._s(e.label)+"\n            ")])})),1),t._v(" "),a("el-select",{staticStyle:{width:"130px"},attrs:{placeholder:"选择客户端IP",size:"mini"},model:{value:t.ip,callback:function(e){t.ip=e},expression:"ip"}},t._l(t.ipSet,(function(e){return a("el-option",{key:e.value,attrs:{value:e.value,label:e.label}},[t._v("\n                "+t._s(e.label)+"\n            ")])})),1),t._v(" "),a("el-select",{staticStyle:{width:"130px"},attrs:{placeholder:"选择操作类型",size:"mini"},model:{value:t.operate,callback:function(e){t.operate=e},expression:"operate"}},t._l(t.operateSet,(function(e){return a("el-option",{key:e.value,attrs:{value:e.value,label:e.label}},[t._v("\n                "+t._s(e.label)+"\n            ")])})),1),t._v(" "),a("el-date-picker",{attrs:{type:"date",placeholder:"起始日期",size:"mini"},model:{value:t.start_time,callback:function(e){t.start_time=e},expression:"start_time"}}),t._v(" "),a("el-date-picker",{attrs:{type:"date",placeholder:"结束日期",size:"mini"},model:{value:t.stop_time,callback:function(e){t.stop_time=e},expression:"stop_time"}}),t._v(" "),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.setTable()}}},[t._v("查询")]),t._v(" "),a("el-button",{attrs:{type:"info",size:"mini"},on:{click:function(e){return t.clear()}}},[t._v("清除")])],1),t._v(" "),a("el-table",{staticStyle:{width:"100%","font-size":"11px"},attrs:{data:t.tableData.slice((t.currentPage-1)*t.pageSize,t.currentPage*t.pageSize),"header-cell-style":{background:"#eef1f6"}}},[a("el-table-column",{attrs:{prop:"id",label:"编号",width:"100px"}}),t._v(" "),a("el-table-column",{attrs:{prop:"time",label:"时间",width:"200px"}}),t._v(" "),a("el-table-column",{attrs:{prop:"ip",label:"IP",width:"200px"}}),t._v(" "),a("el-table-column",{attrs:{prop:"rule",label:"违反规则",width:"150px"}}),t._v(" "),a("el-table-column",{attrs:{prop:"data",label:"敏感信息类型",width:"150px"}}),t._v(" "),a("el-table-column",{attrs:{prop:"operate",label:"操作类型",width:"150px"}}),t._v(" "),a("el-table-column",{attrs:{prop:"name",label:"策略类型"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return t.handleClick(e.row.id)}}},[t._v("详情")]),t._v(" "),a("el-button",{attrs:{type:"text",size:"small"}},[t._v("处理")])]}}])})],1),t._v(" "),a("el-pagination",{attrs:{"current-page":t.currentPage,layout:"prev, pager, next","page-size":t.pageSize,total:t.tableData.length},on:{"current-change":t.handleCurrentChange}}),t._v(" "),a("el-drawer",{ref:"drawer",attrs:{title:"异常事件详情","before-close":t.handleClose,visible:t.open_detail,direction:"rtl","custom-class":"demo-drawer",size:"40%"},on:{"update:visible":function(e){t.open_detail=e}}},[a("div",[t._v("\n      id:"+t._s(t.wrong_detail.id)+"的详情信息\n  ")])])],1)},f=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"result-title"},[a("div",{staticClass:"title-pic"}),t._v(" "),a("div",{staticClass:"title-text"},[t._v("异常事件统计")])])}],v=a("b39f"),m={name:"PartB",data:function(){return{stratedy:"",ip:"",operate:"",start_time:null,stop_time:null,tableData:[],currentPage:1,pageSize:10,stratedySet:[{label:"截屏禁止",value:"screenshot"},{label:"USB禁止",value:"usb"},{label:"Email禁止",value:"email"},{label:"WEB禁止",value:"web"},{label:"打印机禁止",value:"print"},{label:"全部",value:"all"}],ipSet:[],operateSet:[{label:"block",value:"block"},{label:"pass",value:"pass"},{label:"warning",value:"warnning"},{label:"全部",value:"all"}],form:{stratedy:"all",ip:"all",operate:"all",start_time:"all",stop_time:"all"},open_detail:!1,wrong_detail:{time:"",ip:"",rule:"",data:"",operate:"",name:""},changed:!1}},mounted:function(){this.setTable(),this.initIP()},methods:{setTable:function(){var t=this;Object(o["f"])(this.form).then((function(e){t.tableData=e.data}))},initIP:function(){var t=this;Object(v["f"])().then((function(e){t.ipSet=e.data}))},clear:function(){this.stratedy="",this.ip="",this.operate="",this.start_time=null,this.stop_time=null},handleClick:function(t){var e=this;Object(o["e"])(t).then((function(t){e.wrong_detail=t.data})),this.open_detail=!0},handleClose:function(){var t=this;1==this.changed?this.$confirm("你还有未保存修改，是否退出？").then((function(e){t.open_detail=!1,t.wrong_detail={id:"",time:"",ip:"",rule:"",data:"",operate:"",name:""}})):this.open_detail=!1},handleCurrentChange:function(t){this.currentPage=t}}},b=m,_=(a("d1c6"),Object(u["a"])(b,h,f,!1,null,null,null)),g=_.exports,y={data:function(){return{}},components:{PartA:p,PartB:g},methods:{}},x=y,S=(a("112a"),Object(u["a"])(x,l,n,!1,null,null,null));e["default"]=S.exports},bd15:function(t,e,a){},d1c6:function(t,e,a){"use strict";var l=a("bd15"),n=a.n(l);n.a}}]);